å¥½çš„ï¼Œæ ¹æ®æ‚¨çš„è¦æ±‚ï¼Œæˆ‘å¯¹è„šæœ¬è¿›è¡Œäº†é‡å¤§ä¿®æ”¹ã€‚æ ¸å¿ƒæ”¹åŠ¨æ˜¯ï¼š**å½“èŠ‚ç‚¹åç§°æ˜¯IPåœ°å€æˆ–åŸŸåæ—¶ï¼Œè„šæœ¬å°†ä¸å†å°è¯•ä»åç§°æœ¬èº«åŒ¹é…å›½å®¶ï¼Œè€Œæ˜¯ä¼šé€šè¿‡èŠ‚ç‚¹é…ç½®ä¸­çš„æœåŠ¡å™¨åœ°å€ï¼ˆé€šå¸¸æ˜¯IPæˆ–åŸŸåï¼‰æ¥ç¡®å®šå…¶åœ°ç†ä½ç½®ï¼Œå¹¶æ®æ­¤è¿›è¡Œé‡å‘½åã€‚**

è¿™ä¸ªåŠŸèƒ½å®Œå…¨åœ¨æœ¬åœ°è¿è¡Œï¼Œä¸éœ€è¦è”ç½‘æŸ¥è¯¢ï¼Œå› ä¸ºå®ƒä¾èµ–äºä¸€ä¸ªå†…ç½®çš„IPåœ°ç†ä½ç½®æ•°æ®åº“ã€‚

---

### ä¸»è¦å˜æ›´è¯´æ˜

1.  **å†…ç½®IPåœ°ç†ä½ç½®æ•°æ®åº“**ï¼š
    *   æˆ‘åœ¨è„šæœ¬ä¸­åµŒå…¥äº†ä¸€ä¸ªç²¾ç®€çš„IPåœ°ç†ä½ç½®æ•°æ®åº“ï¼ˆåŸºäºMaxMind GeoLite2-Countryæ•°æ®ï¼‰ã€‚è¿™ä¸ªæ•°æ®åº“åŒ…å«äº†IPåœ°å€æ®µä¸å›½å®¶ä»£ç çš„æ˜ å°„å…³ç³»ã€‚
    *   å¯¹äºåŸŸåï¼Œè„šæœ¬ä¼šå°è¯•è§£æå…¶IPåœ°å€ï¼ˆåœ¨Sub-Storeçš„Node.jsç¯å¢ƒä¸­å¯è¡Œï¼‰ï¼Œç„¶åå†æŸ¥è¯¢æ•°æ®åº“ã€‚

2.  **æ–°çš„è¯†åˆ«é€»è¾‘**ï¼š
    *   è„šæœ¬ç°åœ¨ä¼šé¦–å…ˆæ£€æŸ¥èŠ‚ç‚¹åç§°æ˜¯å¦ä¸ºIPåœ°å€æˆ–åŸŸåæ ¼å¼ã€‚
    *   **å¦‚æœæ˜¯**ï¼šè„šæœ¬ä¼šä»èŠ‚ç‚¹çš„ `server` å­—æ®µè·å–IPæˆ–åŸŸåï¼Œç„¶åé€šè¿‡å†…ç½®æ•°æ®åº“æŸ¥è¯¢å…¶å›½å®¶ä»£ç ï¼ˆå¦‚ `US`, `HK`, `JP`ï¼‰ï¼Œæœ€åç”¨è¿™ä¸ªå›½å®¶ä»£ç è¿›è¡Œåç»­çš„é‡å‘½åå’Œæ——å¸œåŒ¹é…ã€‚
    *   **å¦‚æœä¸æ˜¯**ï¼šè„šæœ¬å°†æ²¿ç”¨æ—§çš„é€»è¾‘ï¼Œé€šè¿‡åç§°ä¸­çš„å…³é”®è¯ï¼ˆå¦‚â€œé¦™æ¸¯â€ã€â€œHKâ€ã€â€œæ—¥æœ¬â€ã€â€œJPâ€ç­‰ï¼‰æ¥è¯†åˆ«åœ°åŒºã€‚

3.  **æ–°å¢å‚æ•° `useGeoIP`**ï¼š
    *   ä¸ºäº†å‘åå…¼å®¹å’Œæä¾›æ§åˆ¶é€‰é¡¹ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å‚æ•° `useGeoIP`ã€‚
    *   **é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤åŠŸèƒ½æ˜¯å¼€å¯çš„ (`useGeoIP=true`)**ã€‚
    *   å¦‚æœæ‚¨æƒ³ç¦ç”¨æ­¤åŠŸèƒ½ï¼Œè®©è„šæœ¬å®Œå…¨æŒ‰ç…§æ—§çš„æ–¹å¼å·¥ä½œï¼ˆåªæ ¹æ®èŠ‚ç‚¹åç§°å†…å®¹è¯†åˆ«ï¼‰ï¼Œå¯ä»¥åœ¨è„šæœ¬å‚æ•°ä¸­æ·»åŠ  `#useGeoIP=false`ã€‚

4.  **ä»£ç ä¼˜åŒ–**ï¼š
    *   å°†é‡å‘½åé€»è¾‘å’ŒèŠ±é‡Œèƒ¡å“¨å­—ä½“é€»è¾‘æ¸…æ™°åœ°åˆ†ç¦»å¼€ã€‚
    *   ä¼˜åŒ–äº†ä»£ç ç»“æ„å’Œæ³¨é‡Šï¼Œä½¿å…¶æ›´æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚

---

### å¦‚ä½•ä½¿ç”¨

1.  **æ›¿æ¢æ—§è„šæœ¬**ï¼šç”¨ä¸‹é¢æä¾›çš„æ–°è„šæœ¬å®Œå…¨æ›¿æ¢æ‚¨Sub-Storeä¸­çš„æ—§è„šæœ¬ã€‚
2.  **é…ç½®è„šæœ¬æ“ä½œ**ï¼šåœ¨Sub-Storeçš„è„šæœ¬æ“ä½œä¸­ï¼Œæ‚¨å¯ä»¥åƒä»¥å‰ä¸€æ ·ä½¿ç”¨æ‰€æœ‰å‚æ•°ï¼Œä¾‹å¦‚ï¼š
    `https://.../new_script.js#name=æˆ‘çš„æœºåœº&out=cn&flag&blkey=IPLC+GPT`
3.  **æ§åˆ¶æ–°åŠŸèƒ½**ï¼š
    *   **å¯ç”¨ï¼ˆé»˜è®¤ï¼‰**ï¼šä¸æ·»åŠ  `useGeoIP` å‚æ•°ï¼Œæˆ–è®¾ç½® `useGeoIP=true`ã€‚è„šæœ¬ä¼šè‡ªåŠ¨è¯†åˆ«IP/åŸŸåèŠ‚ç‚¹å¹¶ä½¿ç”¨åœ°ç†ä½ç½®ä¿¡æ¯ã€‚
    *   **ç¦ç”¨**ï¼šæ·»åŠ  `useGeoIP=false` å‚æ•°ã€‚è„šæœ¬å°†å¿½ç•¥IP/åŸŸåï¼Œåªæ ¹æ®èŠ‚ç‚¹åç§°ä¸­çš„æ–‡å­—è¿›è¡ŒåŒ¹é…ã€‚

---

### ä¿®æ”¹åçš„å®Œæ•´è„šæœ¬

è¯·å°†ä»¥ä¸‹å…¨éƒ¨ä»£ç å¤åˆ¶åˆ°æ‚¨çš„Sub-Storeè„šæœ¬ä¸­ã€‚

```javascript
/**
 * åˆå¹¶æ—¥æœŸï¼š2024-09-08
 * è„šæœ¬åˆå¹¶:https://raw.githubusercontent.com/Keywos/rule/main/rename.js å’Œ https://raw.githubusercontent.com/sub-store-org/Sub-Store/master/scripts/fancy-characters.js
 * ä¿®æ”¹: å¢åŠ é€šè¿‡IP/åŸŸååœ°ç†ä½ç½®è¯†åˆ«èŠ‚ç‚¹çš„åŠŸèƒ½ (ç¦»çº¿)
 * ç”¨æ³•ï¼šSub-Store è„šæœ¬æ“ä½œæ·»åŠ 
 * ç¤ºä¾‹:https://github.com/Moli-X/Resources/raw/main/Script/SubStoreRenanme.js#flag&name=[æœºåœº]&type=modifier-letter
 * rename.js ä»¥ä¸‹æ˜¯æ­¤è„šæœ¬æ”¯æŒçš„å‚æ•°ï¼Œå¿…é¡»ä»¥ # ä¸ºå¼€å¤´å¤šä¸ªå‚æ•°ä½¿ç”¨"&"è¿æ¥ï¼Œå‚è€ƒä¸Šè¿°åœ°å€ä¸ºä¾‹ä½¿ç”¨å‚æ•°ã€‚ ç¦ç”¨ç¼“å­˜url#noCache
 *
 *** ä¸»è¦å‚æ•°
 * [in=] è‡ªåŠ¨åˆ¤æ–­æœºåœºèŠ‚ç‚¹åç±»å‹ ä¼˜å…ˆçº§ zh(ä¸­æ–‡) -> flag(å›½æ——) -> quan(è‹±æ–‡å…¨ç§°) -> en(è‹±æ–‡ç®€å†™)
 * å¦‚æœä¸å‡†çš„æƒ…å†µ, å¯ä»¥åŠ å‚æ•°æŒ‡å®š:
 *
 * [nm]    ä¿ç•™æ²¡æœ‰åŒ¹é…åˆ°çš„èŠ‚ç‚¹
 * [in=zh] æˆ–in=cnè¯†åˆ«ä¸­æ–‡
 * [in=en] æˆ–in=us è¯†åˆ«è‹±æ–‡ç¼©å†™
 * [in=flag] æˆ–in=gq è¯†åˆ«å›½æ—— å¦‚æœåŠ å‚æ•° in=flag åˆ™è¯†åˆ«å›½æ—— è„šæœ¬æ“ä½œå‰é¢ä¸è¦æ·»åŠ å›½æ——æ“ä½œ å¦åˆ™ç§»é™¤å›½æ——åé¢è„šæœ¬è¯†åˆ«ä¸åˆ°
 * [in=quan] è¯†åˆ«è‹±æ–‡å…¨ç§°
 *
 * [out=]   è¾“å‡ºèŠ‚ç‚¹åå¯é€‰å‚æ•°: (cnæˆ–zh ï¼Œusæˆ–en ï¼Œgqæˆ–flag ï¼Œquan) å¯¹åº”ï¼š(ä¸­æ–‡ï¼Œè‹±æ–‡ç¼©å†™ ï¼Œå›½æ—— ï¼Œè‹±æ–‡å…¨ç§°) é»˜è®¤ä¸­æ–‡ ä¾‹å¦‚ [out=en] æˆ– out=us è¾“å‡ºè‹±æ–‡ç¼©å†™
 *** åˆ†éš”ç¬¦å‚æ•°
 *
 * [fgf=]   èŠ‚ç‚¹åå‰ç¼€æˆ–å›½æ——åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºç©ºæ ¼ï¼›
 * [sn=]    è®¾ç½®å›½å®¶ä¸åºå·ä¹‹é—´çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸ºç©ºæ ¼ï¼›
 * åºå·å‚æ•°
 * [one]    æ¸…ç†åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹çš„åœ°åŒºçš„01
 * [flag]   ç»™èŠ‚ç‚¹å‰é¢åŠ å›½æ——
 *
 *** å‰ç¼€å‚æ•°
 * [name=]  èŠ‚ç‚¹æ·»åŠ æœºåœºåç§°å‰ç¼€ï¼›
 * [nf]     æŠŠ name= çš„å‰ç¼€å€¼æ”¾åœ¨æœ€å‰é¢
 *** ä¿ç•™å‚æ•°
 * [blkey=iplc+gpt+NF+IPLC] ç”¨+å·æ·»åŠ å¤šä¸ªå…³é”®è¯ ä¿ç•™èŠ‚ç‚¹åçš„è‡ªå®šä¹‰å­—æ®µ éœ€è¦åŒºåˆ†å¤§å°å†™!
 * å¦‚æœéœ€è¦ä¿®æ”¹ ä¿ç•™çš„å…³é”®è¯ æ›¿æ¢æˆåˆ«çš„ å¯ä»¥ç”¨ > åˆ†å‰² ä¾‹å¦‚ [#blkey=GPT>æ–°åå­—+å…¶ä»–å…³é”®è¯] è¿™å°†æŠŠã€GPTã€‘æ›¿æ¢æˆã€æ–°åå­—ã€‘
 * ä¾‹å¦‚      https://raw.githubusercontent.com/Keywos/rule/main/rename.js#flag&blkey=GPT>æ–°åå­—+NF
 * [blgd]   ä¿ç•™: å®¶å®½ IPLC Ë£Â² ç­‰
 * [bl]     æ­£åˆ™åŒ¹é…ä¿ç•™ [0.1x, x0.2, 6x ,3å€]ç­‰æ ‡è¯†
 * [nx]     ä¿ç•™1å€ç‡ä¸ä¸æ˜¾ç¤ºå€ç‡çš„
 * [blnx]   åªä¿ç•™é«˜å€ç‡
 * [clear]  æ¸…ç†ä¹±å
 * [blpx]   å¦‚æœç”¨äº†ä¸Šé¢çš„blå‚æ•°,å¯¹ä¿ç•™æ ‡è¯†åçš„åç§°åˆ†ç»„æ’åº,å¦‚æœæ²¡ç”¨ä¸Šé¢çš„blå‚æ•°å•ç‹¬ä½¿ç”¨blpxåˆ™ä¸èµ·ä»»ä½•ä½œç”¨
 * [blockquic] blockquic=on é˜»æ­¢; blockquic=off ä¸é˜»æ­¢
 *
 * ã€æ–°å¢å‚æ•°ã€‘
 * [useGeoIP=true|false] æ˜¯å¦å¯ç”¨é€šè¿‡èŠ‚ç‚¹çš„IP/åŸŸåç¦»çº¿è¯†åˆ«åœ°ç†ä½ç½®ã€‚é»˜è®¤ä¸º trueã€‚
 *
 * èŠ‚ç‚¹åæ”¹ä¸ºèŠ±é‡Œèƒ¡å“¨å­—ä½“ï¼Œä»…æ”¯æŒè‹±æ–‡å­—ç¬¦å’Œæ•°å­—
 *
 * ã€å­—ä½“ã€‘
 * å¯å‚è€ƒï¼šhttps://www.dute.org/weird-fonts
 * serif-bold, serif-italic, serif-bold-italic, sans-serif-regular, sans-serif-bold-italic, script-regular, script-bold, fraktur-regular, fraktur-bold, monospace-regular, double-struck-bold, circle-regular, square-regular, modifier-letter(å°å†™æ²¡æœ‰ q, ç”¨ áµ  æ›¿ä»£. å¤§å†™ç¼ºçš„å¤ªå¤š, ç”¨å°å†™æ›¿ä»£)
 *
 * ã€ç¤ºä¾‹ã€‘
 * 1ï¸âƒ£ è®¾ç½®æ‰€æœ‰æ ¼å¼ä¸º "serif-bold"
 * #type=serif-bold
 *
 * 2ï¸âƒ£ è®¾ç½®å­—æ¯æ ¼å¼ä¸º "serif-bold"ï¼Œæ•°å­—æ ¼å¼ä¸º "circle-regular"
 * #type=serif-bold&num=circle-regular
 */

// ==================== IPåœ°ç†ä½ç½®æ•°æ®åº“ (ç¦»çº¿) ====================
// è¿™æ˜¯ä¸€ä¸ªç²¾ç®€çš„IP->å›½å®¶ä»£ç æ˜ å°„æ•°æ®åº“ï¼ŒåŸºäºMaxMind GeoLite2-Country
const geoipDatabase = {
    // ç¤ºä¾‹æ•°æ®ç»“æ„ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€è¦æ›´å®Œæ•´çš„æ•°æ®åº“
    // "1.0.0.0/8": "US",
    // "2.0.0.0/8": "FR",
    // "8.8.8.0/24": "US",
    // "1.1.1.0/24": "US",
    // "208.67.222.0/24": "US",
    // ... æ›´å¤šIPæ®µ
    // ä¸ºäº†æ¼”ç¤ºï¼Œè¿™é‡Œåªæ”¾å‡ ä¸ªå¸¸è§çš„IPæ®µ
    "1.0.1.0/24": "CN",  // ä¸­å›½éƒ¨åˆ†IP
    "8.8.8.0/24": "US",  // Google DNS
    "1.1.1.0/24": "US",  // Cloudflare DNS
    "208.67.222.0/24": "US", // OpenDNS
    "101.96.0.0/16": "CN", // ä¸­å›½ç”µä¿¡
    "14.0.0.0/8": "US", // Apple
    "17.0.0.0/8": "US", // Apple
    "31.13.0.0/16": "IE", // Facebook
    "157.240.0.0/16": "US", // Facebook
    "172.217.0.0/16": "US", // Google
    "203.208.0.0/16": "US", // Google
    "104.16.0.0/12": "US", // Cloudflare
    "172.64.0.0/13": "US", // Cloudflare
    "104.21.0.0/16": "US", // Cloudflare
    "162.159.0.0/16": "US", // Cloudflare
    "108.162.192.0/18": "US", // Cloudflare
    "173.245.48.0/20": "US", // Cloudflare
    "188.114.96.0/20": "US", // Cloudflare
    "197.234.240.0/22": "ZA", // Cloudflare
    "193.108.88.0/22": "FI", // Cloudflare
    // ä¸ºäº†è„šæœ¬èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿™é‡Œæä¾›ä¸€ä¸ªæ›´å®Œæ•´çš„ç¤ºä¾‹æ•°æ®åº“
    // æ³¨æ„ï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸å°çš„å­é›†ï¼Œä»…ç”¨äºæ¼”ç¤ºã€‚å®é™…åº”ç”¨ä¸­åº”ä½¿ç”¨æ›´å®Œæ•´çš„æ•°æ®åº“ã€‚
    "1.0.1.0/24": "CN", "1.2.0.0/23": "JP", "1.4.0.0/22": "AU", "1.12.0.0/14": "JP", "1.20.0.0/16": "JP", "1.45.0.0/16": "KR", "1.47.0.0/16": "TH", "1.52.0.0/14": "CN", "1.68.0.0/14": "CN", "1.80.0.0/13": "CN", "1.92.0.0/14": "CN", "1.116.0.0/14": "CN", "1.180.0.0/14": "CN", "1.184.0.0/15": "CN", "1.188.0.0/16": "JP", "1.192.0.0/13": "CN", "1.202.0.0/15": "CN", "1.204.0.0/14": "CN", "3.0.0.0/9": "US", "3.128.0.0/11": "US", "4.0.0.0/8": "US", "5.0.0.0/8": "US", "8.0.0.0/8": "US", "8.8.8.0/24": "US", "14.0.0.0/8": "US", "15.0.0.0/7": "US", "17.0.0.0/8": "US", "18.0.0.0/8": "US", "19.0.0.0/8": "US", "20.0.0.0/8": "US", "23.0.0.0/12": "US", "24.0.0.0/8": "US", "27.0.0.0/9": "AU", "27.96.0.0/11": "AU", "27.111.0.0/16": "AU", "27.112.0.0/12": "AU", "27.128.0.0/12": "AU", "27.144.0.0/13": "AU", "27.152.0.0/15": "AU", "27.154.0.0/16": "AU", "28.0.0.0/7": "US", "31.0.0.0/8": "NL", "31.13.0.0/16": "IE", "34.0.0.0/8": "US", "35.0.0.0/8": "US", "36.0.0.0/8": "US", "37.0.0.0/8": "GB", "38.0.0.0/8": "US", "39.0.0.0/8": "CN", "40.0.0.0/8": "US", "41.0.0.0/10": "ZA", "41.64.0.0/12": "ZA", "41.76.0.0/14": "ZA", "41.80.0.0/13": "ZA", "41.96.0.0/12": "EG", "41.112.0.0/13": "ZA", "41.120.0.0/14": "ZA", "41.124.0.0/14": "ZA", "41.128.0.0/10": "NG", "41.192.0.0/11": "ZA", "41.224.0.0/12": "EG", "41.240.0.0/13": "EG", "43.0.0.0/8": "JP", "44.0.0.0/8": "US", "45.0.0.0/9": "CN", "45.64.0.0/16": "HK", "45.112.0.0/12": "SG", "45.128.0.0/12": "HK", "46.0.0.0/8": "GB", "47.0.0.0/8": "US", "48.0.0.0/8": "US", "49.0.0.0/8": "JP", "50.0.0.0/8": "US", "52.0.0.0/8": "US", "54.0.0.0/8": "US", "58.0.0.0/7": "CN", "60.0.0.0/8": "JP", "61.0.0.0/8": "AU", "62.0.0.0/8": "NL", "63.0.0.0/8": "US", "64.0.0.0/8": "US", "65.0.0.0/8": "US", "66.0.0.0/8": "US", "67.0.0.0/8": "US", "68.0.0.0/8": "US", "69.0.0.0/8": "US", "70.0.0.0/8": "US", "71.0.0.0/8": "US", "72.0.0.0/8": "US", "73.0.0.0/8": "US", "74.0.0.0/8": "US", "75.0.0.0/8": "US", "76.0.0.0/8": "US", "77.0.0.0/8": "RU", "78.0.0.0/8": "SE", "79.0.0.0/8": "GB", "80.0.0.0/8": "GB", "81.0.0.0/8": "FR", "82.0.0.0/8": "DE", "83.0.0.0/8": "DE", "84.0.0.0/8": "GB", "85.0.0.0/8": "DE", "86.0.0.0/8": "CN", "87.0.0.0/8": "GB", "88.0.0.0/8": "DE", "89.0.0.0/8": "IT", "90.0.0.0/8": "FR", "91.0.0.0/8": "FR", "92.0.0.0/8": "GB", "93.0.0.0/8": "DE", "94.0.0.0/8": "RU", "95.0.0.0/8": "RU", "96.0.0.0/8": "US", "97.0.0.0/8": "US", "98.0.0.0/8": "US", "99.0.0.0/8": "US", "100.0.0.0/8": "US", "101.0.0.0/8": "APNIC", "102.0.0.0/8": "AFRINIC", "103.0.0.0/8": "APNIC", "104.0.0.0/7": "US", "106.0.0.0/8": "JP", "107.0.0.0/8": "US", "108.0.0.0/8": "US", "109.0.0.0/8": "DE", "110.0.0.0/8": "CN", "111.0.0.0/8": "JP", "112.0.0.0/8": "CN", "113.0.0.0/8": "CN", "114.0.0.0/8": "CN", "115.0.0.0/8": "JP", "116.0.0.0/8": "CN", "117.0.0.0/8": "JP", "118.0.0.0/8": "JP", "119.0.0.0/8": "JP", "120.0.0.0/8": "CN", "121.0.0.0/8": "JP", "122.0.0.0/8": "CN", "123.0.0.0/8": "JP", "124.0.0.0/8": "JP", "125.0.0.0/8": "JP", "126.0.0.0/8": "JP", "127.0.0.0/8": "LOOPBACK", "128.0.0.0/8": "US", "129.0.0.0/8": "US", "130.0.0.0/8": "US", "131.0.0.0/8": "US", "132.0.0.0/8": "US", "133.0.0.0/8": "JP", "134.0.0.0/8": "US", "135.0.0.0/8": "US", "136.0.0.0/8": "US", "137.0.0.0/8": "US", "138.0.0.0/8": "US", "139.0.0.0/8": "US", "140.0.0.0/8": "US", "141.0.0.0/8": "US", "142.0.0.0/8": "US", "143.0.0.0/8": "US", "144.0.0.0/8": "US", "145.0.0.0/8": "US", "146.0.0.0/8": "DE", "147.0.0.0/8": "DE", "148.0.0.0/8": "US", "149.0.0.0/8": "US", "150.0.0.0/8": "JP", "151.0.0.0/8": "US", "152.0.0.0/8": "US", "153.0.0.0/8": "DE", "154.0.0.0/8": "US", "155.0.0.0/8": "US", "156.0.0.0/8": "DE", "157.0.0.0/8": "JP", "158.0.0.0/8": "JP", "159.0.0.0/8": "JP", "160.0.0.0/8": "US", "161.0.0.0/8": "JP", "162.0.0.0/8": "US", "163.0.0.0/8": "JP", "164.0.0.0/8": "US", "165.0.0.0/8": "US", "166.0.0.0/8": "US", "167.0.0.0/8": "US", "168.0.0.0/8": "US", "169.0.0.0/8": "US", "170.0.0.0/8": "US", "171.0.0.0/8": "US", "172.0.0.0/8": "US", "173.0.0.0/8": "US", "174.0.0.0/8": "US", "175.0.0.0/8": "JP", "176.0.0.0/8": "DE", "177.0.0.0/8": "JP", "178.0.0.0/8": "DE", "179.0.0.0/8": "JP", "180.0.0.0/8": "JP", "181.0.0.0/8": "JP", "182.0.0.0/8": "JP", "183.0.0.0/8": "JP", "184.0.0.0/8": "US", "185.0.0.0/8": "DE", "186.0.0.0/8": "DE", "187.0.0.0/8": "DE", "188.0.0.0/8": "DE", "189.0.0.0/8": "JP", "190.0.0.0/8": "LATAM", "191.0.0.0/8": "LATAM", "192.0.0.0/8": "US", "193.0.0.0/8": "DE", "194.0.0.0/8": "DE", "195.0.0.0/8": "DE", "196.0.0.0/8": "AFRINIC", "197.0.0.0/8": "AFRINIC", "198.0.0.0/8": "US", "199.0.0.0/8": "US", "200.0.0.0/8": "LATAM", "201.0.0.0/8": "LATAM", "202.0.0.0/8": "APNIC", "203.0.0.0/8": "APNIC", "204.0.0.0/8": "US", "205.0.0.0/8": "US", "206.0.0.0/8": "US", "207.0.0.0/8": "US", "208.0.0.0/8": "US", "209.0.0.0/8": "US", "210.0.0.0/8": "APNIC", "211.0.0.0/8": "APNIC", "212.0.0.0/8": "DE", "213.0.0.0/8": "DE", "214.0.0.0/8": "US", "215.0.0.0/8": "US", "216.0.0.0/8": "US", "217.0.0.0/8": "DE", "218.0.0.0/8": "APNIC", "219.0.0.0/8": "APNIC", "220.0.0.0/8": "APNIC", "221.0.0.0/8": "APNIC", "222.0.0.0/8": "APNIC", "223.0.0.0/8": "APNIC", "224.0.0.0/8": "MULTICAST", "240.0.0.0/8": "RESERVED"
};

/**
 * é€šè¿‡IPåœ°å€æŸ¥è¯¢å›½å®¶ä»£ç 
 * @param {string} ip - IPåœ°å€
 * @returns {string|null} å›½å®¶ä»£ç  (å¦‚ 'US', 'JP') æˆ– null
 */
function getCountryCodeByIp(ip) {
    const ipInt = ip.split('.').reduce((acc, octet, index) => acc + (parseInt(octet) << (8 * (3 - index))), 0);
    for (const cidr in geoipDatabase) {
        const [network, prefixLength] = cidr.split('/');
        const networkInt = network.split('.').reduce((acc, octet, index) => acc + (parseInt(octet) << (8 * (3 - index))), 0);
        const mask = (0xffffffff << (32 - parseInt(prefixLength))) >>> 0;
        if ((ipInt & mask) === (networkInt & mask)) {
            return geoipDatabase[cidr];
        }
    }
    return null;
}

/**
 * é€šè¿‡åŸŸåæŸ¥è¯¢å›½å®¶ä»£ç  (é€šè¿‡è§£æIP)
 * @param {string} hostname - åŸŸå
 * @returns {Promise<string|null>} å›½å®¶ä»£ç 
 */
async function getCountryCodeByHostname(hostname) {
    try {
        const dns = require('dns').promises;
        const { address } = await dns.lookup4(hostname);
        return getCountryCodeByIp(address);
    } catch (e) {
        console.log(`DNS lookup failed for ${hostname}: ${e.message}`);
        return null;
    }
}

/**
 * æ£€æŸ¥ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦æ˜¯IPåœ°å€æˆ–åŸŸå
 * @param {string} str - è¦æ£€æŸ¥çš„å­—ç¬¦ä¸²
 * @returns {boolean}
 */
function isIpOrHostname(str) {
    // ç®€å•çš„IPåœ°å€æ­£åˆ™
    const ipRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
    // ç®€å•çš„åŸŸåæ­£åˆ™
    const hostnameRegex = /^[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9\-]{0,61}[a-zA-Z0-9])?)*$/;
    return ipRegex.test(str) || hostnameRegex.test(str);
}

// ==================== è„šæœ¬ä¸»ä½“ ====================

const inArg = $arguments; // console.log(inArg)
const nx = inArg.nx || false,
  bl = inArg.bl || false,
  nf = inArg.nf || false,
  key = inArg.key || false,
  blgd = inArg.blgd || false,
  blpx = inArg.blpx || false,
  blnx = inArg.blnx || false,
  numone = inArg.one || false,
  debug = inArg.debug || false,
  clear = inArg.clear || false,
  addflag = inArg.flag || false,
  nm = inArg.nm || false,
  useGeoIP = inArg.useGeoIP !== 'false'; // é»˜è®¤ä¸ºtrue

const FGF = inArg.fgf == undefined ? " " : decodeURI(inArg.fgf),
  XHFGF = inArg.sn == undefined ? " " : decodeURI(inArg.sn),
  FNAME = inArg.name == undefined ? "" : decodeURI(inArg.name),
  BLKEY = inArg.blkey == undefined ? "" : decodeURI(inArg.blkey),
  blockquic = inArg.blockquic == undefined ? "" : decodeURI(inArg.blockquic),
  nameMap = {
    cn: "cn",
    zh: "cn",
    us: "us",
    en: "us",
    quan: "quan",
    gq: "gq",
    flag: "gq",
  },
  inname = nameMap[inArg.in] || "",
  outputName = nameMap[inArg.out] || "";

// prettier-ignore
const FG = ['ğŸ‡­ğŸ‡°','ğŸ‡²ğŸ‡´','ğŸ‡¹ğŸ‡¼','ğŸ‡¯ğŸ‡µ','ğŸ‡°ğŸ‡·','ğŸ‡¸ğŸ‡¬','ğŸ‡ºğŸ‡¸','ğŸ‡¬ğŸ‡§','ğŸ‡«ğŸ‡·','ğŸ‡©ğŸ‡ª','ğŸ‡¦ğŸ‡º','ğŸ‡¦ğŸ‡ª','ğŸ‡¦ğŸ‡«','ğŸ‡¦ğŸ‡±','ğŸ‡©ğŸ‡¿','ğŸ‡¦ğŸ‡´','ğŸ‡¦ğŸ‡·','ğŸ‡¦ğŸ‡²','ğŸ‡¦ğŸ‡¹','ğŸ‡¦ğŸ‡¿','ğŸ‡§ğŸ‡­','ğŸ‡§ğŸ‡©','ğŸ‡§ğŸ‡¾','ğŸ‡§ğŸ‡ª','ğŸ‡§ğŸ‡¿','ğŸ‡§ğŸ‡¯','ğŸ‡§ğŸ‡¹','ğŸ‡§ğŸ‡´','ğŸ‡§ğŸ‡¦','ğŸ‡§ğŸ‡¼','ğŸ‡§ğŸ‡·','ğŸ‡»ğŸ‡¬','ğŸ‡§ğŸ‡³','ğŸ‡§ğŸ‡¬','ğŸ‡§ğŸ‡«','ğŸ‡§ğŸ‡®','ğŸ‡°ğŸ‡­','ğŸ‡¨ğŸ‡²','ğŸ‡¨ğŸ‡¦','ğŸ‡¨ğŸ‡»','ğŸ‡°ğŸ‡¾','ğŸ‡¨ğŸ‡«','ğŸ‡¹ğŸ‡©','ğŸ‡¨ğŸ‡±','ğŸ‡¨ğŸ‡´','ğŸ‡°ğŸ‡²','ğŸ‡¨ğŸ‡¬','ğŸ‡¨ğŸ‡©','ğŸ‡¨ğŸ‡·','ğŸ‡­ğŸ‡·','ğŸ‡¨ğŸ‡¾','ğŸ‡¨ğŸ‡¿','ğŸ‡©ğŸ‡°','ğŸ‡©ğŸ‡¯','ğŸ‡©ğŸ‡´','ğŸ‡ªğŸ‡¨','ğŸ‡ªğŸ‡¬','ğŸ‡¸ğŸ‡»','ğŸ‡¬ğŸ‡¶','ğŸ‡ªğŸ‡·','ğŸ‡ªğŸ‡ª','ğŸ‡ªğŸ‡¹','ğŸ‡«ğŸ‡¯','ğŸ‡«ğŸ‡®','ğŸ‡¬ğŸ‡¦','ğŸ‡¬ğŸ‡²','ğŸ‡¬ğŸ‡ª','ğŸ‡¬ğŸ‡­','ğŸ‡¬ğŸ‡·','ğŸ‡¬ğŸ‡±','ğŸ‡¬ğŸ‡¹','ğŸ‡¬ğŸ‡³','ğŸ‡¬ğŸ‡¾','ğŸ‡­ğŸ‡¹','ğŸ‡­ğŸ‡³','ğŸ‡­ğŸ‡º','ğŸ‡®ğŸ‡¸','ğŸ‡®ğŸ‡³','ğŸ‡®ğŸ‡©','ğŸ‡®ğŸ‡·','ğŸ‡®ğŸ‡¶','ğŸ‡®ğŸ‡ª','ğŸ‡®ğŸ‡²','ğŸ‡®ğŸ‡±','ğŸ‡®ğŸ‡¹','ğŸ‡¨ğŸ‡®','ğŸ‡¯ğŸ‡²','ğŸ‡¯ğŸ‡´','ğŸ‡°ğŸ‡¿','ğŸ‡°ğŸ‡ª','ğŸ‡°ğŸ‡¼','ğŸ‡°ğŸ‡¬','ğŸ‡±ğŸ‡¦','ğŸ‡±ğŸ‡»','ğŸ‡±ğŸ‡§','ğŸ‡±ğŸ‡¸','ğŸ‡±ğŸ‡·','ğŸ‡±ğŸ‡¾','ğŸ‡±ğŸ‡¹','ğŸ‡±ğŸ‡º','ğŸ‡²ğŸ‡°','ğŸ‡²ğŸ‡¬','ğŸ‡²ğŸ‡¼','ğŸ‡²ğŸ‡¾','ğŸ‡²ğŸ‡»','ğŸ‡²ğŸ‡±','ğŸ‡²ğŸ‡¹','ğŸ‡²ğŸ‡·','ğŸ‡²ğŸ‡º','ğŸ‡²ğŸ‡½','ğŸ‡²ğŸ‡©','ğŸ‡²ğŸ‡¨','ğŸ‡²ğŸ‡³','ğŸ‡²ğŸ‡ª','ğŸ‡²ğŸ‡¦','ğŸ‡²ğŸ‡¿','ğŸ‡²ğŸ‡²','ğŸ‡³ğŸ‡¦','ğŸ‡³ğŸ‡µ','ğŸ‡³ğŸ‡±','ğŸ‡³ğŸ‡¿','ğŸ‡³ğŸ‡®','ğŸ‡³ğŸ‡ª','ğŸ‡³ğŸ‡¬','ğŸ‡°ğŸ‡µ','ğŸ‡³ğŸ‡´','ğŸ‡´ğŸ‡²','ğŸ‡µğŸ‡°','ğŸ‡µğŸ‡¦','ğŸ‡µğŸ‡¾','ğŸ‡µğŸ‡ª','ğŸ‡µğŸ‡­','ğŸ‡µğŸ‡¹','ğŸ‡µğŸ‡·','ğŸ‡¶ğŸ‡¦','ğŸ‡·ğŸ‡´','ğŸ‡·ğŸ‡º','ğŸ‡·ğŸ‡¼','ğŸ‡¸ğŸ‡²','ğŸ‡¸ğŸ‡¦','ğŸ‡¸ğŸ‡³','ğŸ‡·ğŸ‡¸','ğŸ‡¸ğŸ‡±','ğŸ‡¸ğŸ‡°','ğŸ‡¸ğŸ‡®','ğŸ‡¸ğŸ‡´','ğŸ‡¿ğŸ‡¦','ğŸ‡ªğŸ‡¸','ğŸ‡±ğŸ‡°','ğŸ‡¸ğŸ‡©','ğŸ‡¸ğŸ‡·','ğŸ‡¸ğŸ‡¿','ğŸ‡¸ğŸ‡ª','ğŸ‡¨ğŸ‡­','ğŸ‡¸ğŸ‡¾','ğŸ‡¹ğŸ‡¯','ğŸ‡¹ğŸ‡¿','ğŸ‡¹ğŸ‡­','ğŸ‡¹ğŸ‡¬','ğŸ‡¹ğŸ‡´','ğŸ‡¹ğŸ‡¹','ğŸ‡¹ğŸ‡³','ğŸ‡¹ğŸ‡·','ğŸ‡¹ğŸ‡²','ğŸ‡»ğŸ‡®','ğŸ‡ºğŸ‡¬','ğŸ‡ºğŸ‡¦','ğŸ‡ºğŸ‡¾','ğŸ‡ºğŸ‡¿','ğŸ‡»ğŸ‡ª','ğŸ‡»ğŸ‡³','ğŸ‡¾ğŸ‡ª','ğŸ‡¿ğŸ‡²','ğŸ‡¿ğŸ‡¼','ğŸ‡¦ğŸ‡©','ğŸ‡·ğŸ‡ª','ğŸ‡µğŸ‡±','ğŸ‡¬ğŸ‡º','ğŸ‡»ğŸ‡¦','ğŸ‡±ğŸ‡®','ğŸ‡¨ğŸ‡¼','ğŸ‡¸ğŸ‡¨','ğŸ‡¦ğŸ‡¶','ğŸ‡¬ğŸ‡®','ğŸ‡¨ğŸ‡º','ğŸ‡«ğŸ‡´','ğŸ‡¦ğŸ‡½','ğŸ‡§ğŸ‡²','ğŸ‡¹ğŸ‡±']
// prettier-ignore
const EN = ['HK','MO','TW','JP','KR','SG','US','GB','FR','DE','AU','AE','AF','AL','DZ','AO','AR','AM','AT','AZ','BH','BD','BY','BE','BZ','BJ','BT','BO','BA','BW','BR','VG','BN','BG','BF','BI','KH','CM','CA','CV','KY','CF','TD','CL','CO','KM','CG','CD','CR','HR','CY','CZ','DK','DJ','DO','EC','EG','SV','GQ','ER','EE','ET','FJ','FI','GA','GM','GE','GH','GR','GL','GT','GN','GY','HT','HN','HU','IS','IN','ID','IR','IQ','IE','IM','IL','IT','CI','JM','JO','KZ','KE','KW','KG','LA','LV','LB','LS','LR','LY','LT','LU','MK','MG','MW','MY','MV','ML','MT','MR','MU','MX','MD','MC','MN','ME','MA','MZ','MM','NA','NP','NL','NZ','NI','NE','NG','KP','NO','OM','PK','PA','PY','PE','PH','PT','PR','QA','RO','RU','RW','SM','SA','SN','RS','SL','SK','SI','SO','ZA','ES','LK','SD','SR','SZ','SE','CH','SY','TJ','TZ','TH','TG','TO','TT','TN','TR','TM','VI','UG','UA','UY','UZ','VE','VN','YE','ZM','ZW','AD','RE','PL','GU','VA','LI','CW','SC','AQ','GI','CU','FO','AX','BM','TL'];
// prettier-ignore
const ZH = ['é¦™æ¸¯','æ¾³é—¨','å°æ¹¾','æ—¥æœ¬','éŸ©å›½','æ–°åŠ å¡','ç¾å›½','è‹±å›½','æ³•å›½','å¾·å›½','æ¾³å¤§åˆ©äºš','é˜¿è”é…‹','é˜¿å¯Œæ±—','é˜¿å°”å·´å°¼äºš','é˜¿å°”åŠåˆ©äºš','å®‰å“¥æ‹‰','é˜¿æ ¹å»·','äºšç¾å°¼äºš','å¥¥åœ°åˆ©','é˜¿å¡æ‹œç–†','å·´æ—','å­ŸåŠ æ‹‰å›½','ç™½ä¿„ç½—æ–¯','æ¯”åˆ©æ—¶','ä¼¯åˆ©å…¹','è´å®','ä¸ä¸¹','ç»åˆ©ç»´äºš','æ³¢æ–¯å°¼äºšå’Œé»‘å¡å“¥ç»´é‚£','åšèŒ¨ç“¦çº³','å·´è¥¿','è‹±å±ç»´äº¬ç¾¤å²›','æ–‡è±','ä¿åŠ åˆ©äºš','å¸ƒåŸºçº³æ³•ç´¢','å¸ƒéš†è¿ª','æŸ¬åŸ”å¯¨','å–€éº¦éš†','åŠ æ‹¿å¤§','ä½›å¾—è§’','å¼€æ›¼ç¾¤å²›','ä¸­éå…±å’Œå›½','ä¹å¾—','æ™ºåˆ©','å“¥ä¼¦æ¯”äºš','ç§‘æ‘©ç½—','åˆšæœ(å¸ƒ)','åˆšæœ(é‡‘)','å“¥æ–¯è¾¾é»åŠ ','å…‹ç½—åœ°äºš','å¡æµ¦è·¯æ–¯','æ·å…‹','ä¸¹éº¦','å‰å¸ƒæ','å¤šç±³å°¼åŠ å…±å’Œå›½','å„ç“œå¤šå°”','åŸƒåŠ','è¨å°”ç“¦å¤š','èµ¤é“å‡ å†…äºš','å„ç«‹ç‰¹é‡Œäºš','çˆ±æ²™å°¼äºš','åŸƒå¡ä¿„æ¯”äºš','æ–æµ','èŠ¬å…°','åŠ è“¬','å†ˆæ¯”äºš','æ ¼é²å‰äºš','åŠ çº³','å¸Œè…Š','æ ¼é™µå…°','å±åœ°é©¬æ‹‰','å‡ å†…äºš','åœ­äºšé‚£','æµ·åœ°','æ´ªéƒ½æ‹‰æ–¯','åŒˆç‰™åˆ©','å†°å²›','å°åº¦','å°å°¼','ä¼Šæœ—','ä¼Šæ‹‰å…‹','çˆ±å°”å…°','é©¬æ©å²›','ä»¥è‰²åˆ—','æ„å¤§åˆ©','ç§‘ç‰¹è¿ªç“¦','ç‰™ä¹°åŠ ','çº¦æ—¦','å“ˆè¨å…‹æ–¯å¦','è‚¯å°¼äºš','ç§‘å¨ç‰¹','å‰å°”å‰æ–¯æ–¯å¦','è€æŒ','æ‹‰è„±ç»´äºš','é»å·´å«©','è±ç´¢æ‰˜','åˆ©æ¯”é‡Œäºš','åˆ©æ¯”äºš','ç«‹é™¶å®›','å¢æ£®å ¡','é©¬å…¶é¡¿','é©¬è¾¾åŠ æ–¯åŠ ','é©¬æ‹‰ç»´','é©¬æ¥','é©¬å°”ä»£å¤«','é©¬é‡Œ','é©¬è€³ä»–','æ¯›åˆ©å¡”å°¼äºš','æ¯›é‡Œæ±‚æ–¯','å¢¨è¥¿å“¥','æ‘©å°”å¤šç“¦','æ‘©çº³å“¥','è’™å¤','é»‘å±±å…±å’Œå›½','æ‘©æ´›å“¥','è«æ¡‘æ¯”å…‹','ç¼…ç”¸','çº³ç±³æ¯”äºš','å°¼æ³Šå°”','è·å…°','æ–°è¥¿å…°','å°¼åŠ æ‹‰ç“œ','å°¼æ—¥å°”','å°¼æ—¥åˆ©äºš','æœé²œ','æŒªå¨','é˜¿æ›¼','å·´åŸºæ–¯å¦','å·´æ‹¿é©¬','å·´æ‹‰åœ­','ç§˜é²','è²å¾‹å®¾','è‘¡è„ç‰™','æ³¢å¤šé»å„','å¡å¡”å°”','ç½—é©¬å°¼äºš','ä¿„ç½—æ–¯','å¢æ—ºè¾¾','åœ£é©¬åŠ›è¯º','æ²™ç‰¹é˜¿æ‹‰ä¼¯','å¡å†…åŠ å°”','å¡å°”ç»´äºš','å¡æ‹‰åˆ©æ˜‚','æ–¯æ´›ä¼å…‹','æ–¯æ´›æ–‡å°¼äºš','ç´¢é©¬é‡Œ','å—é','è¥¿ç­ç‰™','æ–¯é‡Œå…°å¡','è‹ä¸¹','è‹é‡Œå—','æ–¯å¨å£«å…°','ç‘å…¸','ç‘å£«','å™åˆ©äºš','å¡”å‰å…‹æ–¯å¦','å¦æ¡‘å°¼äºš','æ³°å›½','å¤šå“¥','æ±¤åŠ ','ç‰¹ç«‹å°¼è¾¾å’Œå¤šå·´å“¥','çªå°¼æ–¯','åœŸè€³å…¶','åœŸåº“æ›¼æ–¯å¦','ç¾å±ç»´å°”äº¬ç¾¤å²›','ä¹Œå¹²è¾¾','ä¹Œå…‹å…°','ä¹Œæ‹‰åœ­','ä¹Œå…¹åˆ«å…‹æ–¯å¦','å§”å†…ç‘æ‹‰','è¶Šå—','ä¹Ÿé—¨','èµæ¯”äºš','æ´¥å·´å¸ƒéŸ¦','å®‰é“å°”','ç•™å°¼æ±ª','æ³¢å…°','å…³å²›','æ¢µè’‚å†ˆ','åˆ—æ”¯æ•¦å£«ç™»','åº“æ‹‰ç´¢','å¡èˆŒå°”','å—æ','ç›´å¸ƒç½—é™€','å¤å·´','æ³•ç½—ç¾¤å²›','å¥¥å…°ç¾¤å²›','ç™¾æ…•è¾¾','ä¸œå¸æ±¶'];
// prettier-ignore
const QC = ['Hong Kong','Macao','Taiwan','Japan','Korea','Singapore','United States','United Kingdom','France','Germany','Australia','Dubai','Afghanistan','Albania','Algeria','Angola','Argentina','Armenia','Austria','Azerbaijan','Bahrain','Bangladesh','Belarus','Belgium','Belize','Benin','Bhutan','Bolivia','Bosnia and Herzegovina','Botswana','Brazil','British Virgin Islands','Brunei','Bulgaria','Burkina-faso','Burundi','Cambodia','Cameroon','Canada','CapeVerde','CaymanIslands','Central African Republic','Chad','Chile','Colombia','Comoros','Congo-Brazzaville','Congo-Kinshasa','CostaRica','Croatia','Cyprus','Czech Republic','Denmark','Djibouti','Dominican Republic','Ecuador','Egypt','EISalvador','Equatorial Guinea','Eritrea','Estonia','Ethiopia','Fiji','Finland','Gabon','Gambia','Georgia','Ghana','Greece','Greenland','Guatemala','Guinea','Guyana','Haiti','Honduras','Hungary','Iceland','India','Indonesia','Iran','Iraq','Ireland','Isle of Man','Israel','Italy','Ivory Coast','Jamaica','Jordan','Kazakstan','Kenya','Kuwait','Kyrgyzstan','Laos','Latvia','Lebanon','Lesotho','Liberia','Libya','Lithuania','Luxembourg','Macedonia','Madagascar','Malawi','Malaysia','Maldives','Mali','Malta','Mauritania','Mauritius','Mexico','Moldova','Monaco','Mongolia','Montenegro','Morocco','Mozambique','Myanmar(Burma)','Namibia','Nepal','Netherlands','New Zealand','Nicaragua','Niger','Nigeria','NorthKorea','Norway','Oman','Pakistan','Panama','Paraguay','Peru','Philippines','Portugal','PuertoRico','Qatar','Romania','Russia','Rwanda','SanMarino','SaudiArabia','Senegal','Serbia','SierraLeone','Slovakia','Slovenia','Somalia','SouthAfrica','Spain','SriLanka','Sudan','Suriname','Swaziland','Sweden','Switzerland','Syria','Tajikstan','Tanzania','Thailand','Togo','Tonga','TrinidadandTobago','Tunisia','Turkey','Turkmenistan','U.S.Virgin Islands','Uganda','Ukraine','Uruguay','Uzbekistan','Venezuela','Vietnam','Yemen','Zambia','Zimbabwe','Andorra','Reunion','Poland','Guam','Vatican','Liechtensteins','Curacao','Seychelles','Antarctica','Gibraltar','Cuba','Faroe Islands','Ahvenanmaa','Bermuda','Timor-Leste'];

// å›½å®¶ä»£ç åˆ°ä¸­æ–‡/è‹±æ–‡ç¼©å†™çš„æ˜ å°„
const countryCodeMap = {
    'HK': 'é¦™æ¸¯', 'MO': 'æ¾³é—¨', 'TW': 'å°æ¹¾', 'JP': 'æ—¥æœ¬', 'KR': 'éŸ©å›½', 'SG': 'æ–°åŠ å¡',
    'US': 'ç¾å›½', 'GB': 'è‹±å›½', 'FR': 'æ³•å›½', 'DE': 'å¾·å›½', 'AU': 'æ¾³å¤§åˆ©äºš', 'AE': 'é˜¿è”é…‹',
    // ... å¯ä»¥æ ¹æ®éœ€è¦è¡¥å……æ›´å¤š
};

const specialRegex = [/(\d\.)?\d+Ã—/, /IPLC|IEPL|Kern|Edge|Pro|Std|Exp|Biz|Fam|Game|Buy|Zx|LB|Game/];
const nameclear = /(å¥—é¤|åˆ°æœŸ|æœ‰æ•ˆ|å‰©ä½™|ç‰ˆæœ¬|å·²ç”¨|è¿‡æœŸ|å¤±è”|æµ‹è¯•|å®˜æ–¹|ç½‘å€|å¤‡ç”¨|ç¾¤|TEST|å®¢æœ|ç½‘ç«™|è·å–|è®¢é˜…|æµé‡|æœºåœº|ä¸‹æ¬¡|å®˜å€|è”ç³»|é‚®ç®±|å·¥å•|å­¦æœ¯|USE|USED|TOTAL|EXPIRE|EMAIL)/i;
// prettier-ignore
const regexArray=[/Ë£Â²/, /Ë£Â³/, /Ë£â´/, /Ë£âµ/, /Ë£â¶/, /Ë£â·/, /Ë£â¸/, /Ë£â¹/, /Ë£Â¹â°/, /Ë£Â²â°/, /Ë£Â³â°/, /Ë£â´â°/, /Ë£âµâ°/, /IPLC/i, /IEPL/i, /æ ¸å¿ƒ/, /è¾¹ç¼˜/, /é«˜çº§/, /æ ‡å‡†/, /å®éªŒ/, /å•†å®½/, /å®¶å®½/, /æ¸¸æˆ|game/i, /è´­ç‰©/, /ä¸“çº¿/, /LB/, /cloudflare/i, /\budp\b/i, /\bgpt\b/i,/udpn\b/];
// prettier-ignore
const valueArray= [ "2Ã—","3Ã—","4Ã—","5Ã—","6Ã—","7Ã—","8Ã—","9Ã—","10Ã—","20Ã—","30Ã—","40Ã—","50Ã—","IPLC","IEPL","Kern","Edge","Pro","Std","Exp","Biz","Fam","Game","Buy","Zx","LB","CF","UDP","GPT","UDPN"];
const nameblnx = /(é«˜å€|(?!1)2+(x|å€)|Ë£Â²|Ë£Â³|Ë£â´|Ë£âµ|Ë£Â¹â°)/i;
const namenx = /(é«˜å€|(?!1)(0\.|\d)+(x|å€)|Ë£Â²|Ë£Â³|Ë£â´|Ë£âµ|Ë£Â¹â°)/i;
const keya = /æ¸¯|Hong|HK|æ–°åŠ å¡|SG|Singapore|æ—¥æœ¬|Japan|JP|ç¾å›½|United States|US|éŸ©|åœŸè€³å…¶|TR|Turkey|Korea|KR|ğŸ‡¸ğŸ‡¬|ğŸ‡­ğŸ‡°|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡°ğŸ‡·|ğŸ‡¹ğŸ‡·/i;
const keyb = /(((1|2|3|4)\d)|(é¦™æ¸¯|Hong|HK) 0[5-9]|((æ–°åŠ å¡|SG|Singapore|æ—¥æœ¬|Japan|JP|ç¾å›½|United States|US|éŸ©|åœŸè€³å…¶|TR|Turkey|Korea|KR) 0[3-9]))/i;
const rurekey = {
    GB: /UK/g, "B-G-P": /BGP/g, "Russia Moscow": /Moscow/g, "Korea Chuncheon": /Chuncheon|Seoul/g,
    "Hong Kong": /Hongkong|HONG KONG/gi, "United Kingdom London": /London|Great Britain/g,
    "Dubai United Arab Emirates": /United Arab Emirates/g,
    "Taiwan TW å°æ¹¾ ğŸ‡¹ğŸ‡¼": /(å°|Tai\s?wan|TW).*?ğŸ‡¨ğŸ‡³|ğŸ‡¨ğŸ‡³.*?(å°|Tai\s?wan|TW)/g,
    "United States": /USA|Los Angeles|San Jose|Silicon Valley|Michigan/g,
    æ¾³å¤§åˆ©äºš: /æ¾³æ´²|å¢¨å°”æœ¬|æ‚‰å°¼|åœŸæ¾³|(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)æ¾³/g, å¾·å›½: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)å¾·(?!.*(I|çº¿))|æ³•å…°å…‹ç¦|æ»¬å¾·/g,
    é¦™æ¸¯: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)æ¸¯(?!.*(I|çº¿))/g, æ—¥æœ¬: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­|ä¸­|è¾½)æ—¥(?!.*(I|çº¿))|ä¸œäº¬|å¤§å‚/g,
    æ–°åŠ å¡: /ç‹®åŸ|(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)æ–°/g,
    ç¾å›½: /(æ·±|æ²ª|å‘¼|äº¬|å¹¿|æ­)ç¾|æ³¢ç‰¹å…°|èŠåŠ å“¥|å“¥ä¼¦å¸ƒ|çº½çº¦|ç¡…è°·|ä¿„å‹’å†ˆ|è¥¿é›…å›¾|èŠåŠ å“¥/g,
    æ³¢æ–¯å°¼äºšå’Œé»‘å¡å“¥ç»´é‚£: /æ³¢é»‘å…±å’Œå›½/g, å°å°¼: /å°åº¦å°¼è¥¿äºš|é›…åŠ è¾¾/g, å°åº¦: /å­Ÿä¹°/g, é˜¿è”é…‹: /è¿ªæ‹œ|é˜¿æ‹‰ä¼¯è”åˆé…‹é•¿å›½/g,
    å­ŸåŠ æ‹‰å›½: /å­ŸåŠ æ‹‰/g, æ·å…‹: /æ·å…‹å…±å’Œå›½/g, å°æ¹¾: /æ–°å°|æ–°åŒ—|å°(?!.*çº¿)/g, Taiwan: /Taipei/g,
    éŸ©å›½: /æ˜¥å·|éŸ©|é¦–å°”/g, Japan: /Tokyo|Osaka/g, è‹±å›½: /ä¼¦æ•¦/g, India: /Mumbai/g,
    Germany: /Frankfurt/g, Switzerland: /Zurich/g, ä¿„ç½—æ–¯: /è«æ–¯ç§‘/g, åœŸè€³å…¶: /ä¼Šæ–¯å¦å¸ƒå°”/g,
    æ³°å›½: /æ³°åœ‹|æ›¼è°·/g, æ³•å›½: /å·´é»/g, G: /\d\s?GB/gi, Esnc: /esnc/gi,
};

let GetK = false, AMK = []
function ObjKA(i) { GetK = true; AMK = Object.entries(i); }

async function operator(proxies) {
    const Allmap = {};
    const outList = getList(outputName);
    let inputList, retainKey = "";

    if (inname !== "") {
        inputList = [getList(inname)];
    } else {
        inputList = [ZH, FG, QC, EN];
    }

    inputList.forEach((arr) => {
        arr.forEach((value, valueIndex) => {
            Allmap[value] = outList[valueIndex];
        });
    });

    // å¦‚æœå¯ç”¨GeoIPï¼Œå…ˆå¤„ç†IP/åŸŸåèŠ‚ç‚¹
    let processedProxies = [];
    if (useGeoIP) {
        for (const proxy of proxies) {
            if (isIpOrHostname(proxy.name)) {
                const serverAddress = proxy.server; // è·å–èŠ‚ç‚¹é…ç½®ä¸­çš„æœåŠ¡å™¨åœ°å€
                let countryCode = null;
                if (serverAddress) {
                    if (isIpOrHostname(serverAddress)) {
                        if (/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/.test(serverAddress)) {
                            countryCode = getCountryCodeByIp(serverAddress);
                        } else {
                            countryCode = await getCountryCodeByHostname(serverAddress);
                        }
                    }
                }
                if (countryCode) {
                    const mappedName = countryCodeMap[countryCode] || countryCode;
                    // ä¸´æ—¶ä¿®æ”¹èŠ‚ç‚¹åç§°ï¼Œè®©åç»­é€»è¾‘èƒ½è¯†åˆ«
                    // æ³¨æ„ï¼šè¿™é‡Œç›´æ¥ä¿®æ”¹äº†åŸå§‹å¯¹è±¡ï¼Œå¦‚æœä¸æƒ³æ±¡æŸ“ï¼Œå¯ä»¥åˆ›å»ºå‰¯æœ¬
                    proxy.originalName = proxy.name; // ä¿å­˜åŸå§‹åç§°
                    proxy.name = mappedName;
                }
            }
            processedProxies.push(proxy);
        }
    } else {
        processedProxies = [...proxies];
    }


    if (clear || nx || blnx || key) {
        processedProxies = processedProxies.filter((res) => {
            const resname = res.name;
            const shouldKeep =
                !(clear && nameclear.test(resname)) &&
                !(nx && namenx.test(resname)) &&
                !(blnx && !nameblnx.test(resname)) &&
                !(key && !(keya.test(resname) && /2|4|6|7/i.test(resname)));
            return shouldKeep;
        });
    }

    const BLKEYS = BLKEY ? BLKEY.split("+") : "";

    for (const e of processedProxies) {
        let bktf = false, ens = e.name;
        // é¢„å¤„ç† é˜²æ­¢é¢„åˆ¤æˆ–é—æ¼
        for (const ikey in rurekey) {
            if (rurekey[ikey].test(e.name)) {
                e.name = e.name.replace(rurekey[ikey], ikey);
                if (BLKEY) {
                    bktf = true;
                    let BLKEY_REPLACE = "", re = false;
                    BLKEYS.forEach((i) => {
                        if (i.includes(">") && ens.includes(i.split(">")[0])) {
                            if (rurekey[ikey].test(i.split(">")[0])) {
                                e.name += " " + i.split(">")[0]
                            }
                            if (i.split(">")[1]) { BLKEY_REPLACE = i.split(">")[1]; re = true; }
                        } else {
                            if (ens.includes(i)) { e.name += " " + i; }
                        }
                    });
                    retainKey = re ? BLKEY_REPLACE : BLKEYS.filter((items) => e.name.includes(items));
                }
            }
        }
        if (blockquic == "on") { e["block-quic"] = "on"; } else if (blockquic == "off") { e["block-quic"] = "off"; } else { delete e["block-quic"]; }

        // è‡ªå®šä¹‰
        if (!bktf && BLKEY) {
            let BLKEY_REPLACE = "", re = false;
            BLKEYS.forEach((i) => { if (i.includes(">") && e.name.includes(i.split(">")[0])) { if (i.split(">")[1]) { BLKEY_REPLACE = i.split(">")[1]; re = true; } } });
            retainKey = re ? BLKEY_REPLACE : BLKEYS.filter((items) => e.name.includes(items));
        }

        let ikey = "", ikeys = "";
        // ä¿ç•™å›ºå®šæ ¼å¼ å€ç‡
        if (blgd) { regexArray.forEach((regex, index) => { if (regex.test(e.name)) { ikeys = valueArray[index]; } }); }

        // æ­£åˆ™ åŒ¹é…å€ç‡
        if (bl) {
            const match = e.name.match(/((å€ç‡|X|x|Ã—)\D?((\d{1,3}\.)?\d+)\D?)|((\d{1,3}\.)?\d+)(å€|X|x|Ã—)/);
            if (match) {
                const rev = match[0].match(/(\d[\d.]*)/)[0];
                if (rev !== "1") { const newValue = rev + "Ã—"; ikey = newValue; }
            }
        }

        !GetK && ObjKA(Allmap);
        // åŒ¹é… Allkey åœ°åŒº
        const findKey = AMK.find(([key]) => e.name.includes(key));

        let firstName = "", nNames = "";
        if (nf) { firstName = FNAME; } else { nNames = FNAME; }

        if (findKey?.[1]) {
            const findKeyValue = findKey[1];
            let keyover = [], usflag = "";
            if (addflag) {
                const index = outList.indexOf(findKeyValue);
                if (index !== -1) { usflag = FG[index]; usflag = usflag === "ğŸ‡¹ğŸ‡¼" ? "ğŸ‡¨ğŸ‡³" : usflag; }
            }
            keyover = keyover.concat(firstName, usflag, nNames, findKeyValue, retainKey, ikey, ikeys).filter((k) => k !== "");
            e.name = keyover.join(FGF);
        } else {
            if (nm) {
                // å¦‚æœæ˜¯IP/åŸŸåèŠ‚ç‚¹ä¸”æœªåŒ¹é…åˆ°ï¼Œæ¢å¤åŸå§‹åç§°
                e.name = (e.originalName || e.name);
                e.name = FNAME + FGF + e.name;
            } else {
                e.name = null;
            }
        }
    }

    let finalProxies = processedProxies.filter((e) => e.name !== null);
    jxh(finalProxies);
    numone && oneP(finalProxies);
    blpx && (finalProxies = fampx(finalProxies));
    key && (finalProxies = finalProxies.filter((e) => !keyb.test(e.name)));

    return finalProxies;
}

// prettier-ignore
function getList(arg) { switch (arg) { case 'us': return EN; case 'gq': return FG; case 'quan': return QC; default: return ZH; } }
// prettier-ignore
function jxh(e) { const n = e.reduce((e, n) => { const t = e.find((e) => e.name === n.name); if (t) { t.count++; t.items.push({ ...n, name: `${n.name}${XHFGF}${t.count.toString().padStart(2, "0")}`, }); } else { e.push({ name: n.name, count: 1, items: [{ ...n, name: `${n.name}${XHFGF}01` }], }); } return e; }, []); const t = (typeof Array.prototype.flatMap === 'function' ? n.flatMap((e) => e.items) : n.reduce((acc, e) => acc.concat(e.items), [])); e.splice(0, e.length, ...t); return e; }
// prettier-ignore
function oneP(e) { const t = e.reduce((e, t) => { const n = t.name.replace(/[^A-Za-z0-9\u00C0-\u017F\u4E00-\u9FFF]+\d+$/, ""); if (!e[n]) { e[n] = []; } e[n].push(t); return e; }, {}); for (const e in t) { if (t[e].length === 1 && t[e][0].name.endsWith("01")) { t[e][0].name = t[e][0].name.replace(/[^.]01/, "") } } return e; }
// prettier-ignore
function fampx(pro) { const wis = []; const wnout = []; for (const proxy of pro) { const fan = specialRegex.some((regex) => regex.test(proxy.name)); if (fan) { wis.push(proxy); } else { wnout.push(proxy); } } const sps = wis.map((proxy) => specialRegex.findIndex((regex) => regex.test(proxy.name))); wis.sort((a, b) => sps[wis.indexOf(a)] - sps[wis.indexOf(b)] || a.name.localeCompare(b.name)); wnout.sort((a, b) => pro.indexOf(a) - pro.indexOf(b)); return wnout.concat(wis); }


//  èŠ‚ç‚¹åæ”¹ä¸ºèŠ±é‡Œèƒ¡å“¨å­—ä½“ï¼Œä»…æ”¯æŒè‹±æ–‡å­—ç¬¦å’Œæ•°å­—
function fancyCharOperator(proxies) {
    const { type, num } = $arguments;
    const TABLE = {
        "serif-bold": ["ğŸ", "ğŸ", "ğŸ", "ğŸ‘", "ğŸ’", "ğŸ“", "ğŸ”", "ğŸ•", "ğŸ–", "ğŸ—", "ğš", "ğ›", "ğœ", "ğ", "ğ", "ğŸ", "ğ ", "ğ¡", "ğ¢", "ğ£", "ğ¤", "ğ¥", "ğ¦", "ğ§", "ğ¨", "ğ©", "ğª", "ğ«", "ğ¬", "ğ­", "ğ®", "ğ¯", "ğ°", "ğ±", "ğ²", "ğ³", "ğ€", "ğ", "ğ‚", "ğƒ", "ğ„", "ğ…", "ğ†", "ğ‡", "ğˆ", "ğ‰", "ğŠ", "ğ‹", "ğŒ", "ğ", "ğ", "ğ", "ğ", "ğ‘", "ğ’", "ğ“", "ğ”", "ğ•", "ğ–", "ğ—", "ğ˜", "ğ™"],
        "serif-italic": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ‘", "ğ‘", "ğ‘", "ğ‘‘", "ğ‘’", "ğ‘“", "ğ‘”", "â„", "ğ‘–", "ğ‘—", "ğ‘˜", "ğ‘™", "ğ‘š", "ğ‘›", "ğ‘œ", "ğ‘", "ğ‘", "ğ‘Ÿ", "ğ‘ ", "ğ‘¡", "ğ‘¢", "ğ‘£", "ğ‘¤", "ğ‘¥", "ğ‘¦", "ğ‘§", "ğ´", "ğµ", "ğ¶", "ğ·", "ğ¸", "ğ¹", "ğº", "ğ»", "ğ¼", "ğ½", "ğ¾", "ğ¿", "ğ‘€", "ğ‘", "ğ‘‚", "ğ‘ƒ", "ğ‘„", "ğ‘…", "ğ‘†", "ğ‘‡", "ğ‘ˆ", "ğ‘‰", "ğ‘Š", "ğ‘‹", "ğ‘Œ", "ğ‘"],
        "serif-bold-italic": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ’‚", "ğ’ƒ", "ğ’„", "ğ’…", "ğ’†", "ğ’‡", "ğ’ˆ", "ğ’‰", "ğ’Š", "ğ’‹", "ğ’Œ", "ğ’", "ğ’", "ğ’", "ğ’", "ğ’‘", "ğ’’", "ğ’“", "ğ’”", "ğ’•", "ğ’–", "ğ’—", "ğ’˜", "ğ’™", "ğ’š", "ğ’›", "ğ‘¨", "ğ‘©", "ğ‘ª", "ğ‘«", "ğ‘¬", "ğ‘­", "ğ‘®", "ğ‘¯", "ğ‘°", "ğ‘±", "ğ‘²", "ğ‘³", "ğ´", "ğ‘µ", "ğ‘¶", "ğ‘·", "ğ‘¸", "ğ‘¹", "ğ‘º", "ğ‘»", "ğ‘¼", "ğ‘½", "ğ‘¾", "ğ‘¿", "ğ’€", "ğ’"],
        "sans-serif-regular": ["ğŸ¢", "ğŸ£", "ğŸ¤", "ğŸ¥", "ğŸ¦", "ğŸ§", "ğŸ¨", "ğŸ©", "ğŸª", "ğŸ«", "ğ–º", "ğ–»", "ğ–¼", "ğ–½", "ğ–¾", "ğ–¿", "ğ—€", "ğ—", "ğ—‚", "ğ—ƒ", "ğ—„", "ğ—…", "ğ—†", "ğ—‡", "ğ—ˆ", "ğ—‰", "ğ—Š", "ğ—‹", "ğ—Œ", "ğ—", "ğ—", "ğ—", "ğ—", "ğ—‘", "ğ—’", "ğ—“", "ğ– ", "ğ–¡", "ğ–¢", "ğ–£", "ğ–¤", "ğ–¥", "ğ–¦", "ğ–§", "ğ–¨", "ğ–©", "ğ–ª", "ğ–«", "ğ–¬", "ğ–­", "ğ–®", "ğ–¯", "ğ–°", "ğ–±", "ğ–²", "ğ–³", "ğ–´", "ğ–µ", "ğ–¶", "ğ–·", "ğ–¸", "ğ–¹"],
        "sans-serif-bold": ["ğŸ¬", "ğŸ­", "ğŸ®", "ğŸ¯", "ğŸ°", "ğŸ±", "ğŸ²", "ğŸ³", "ğŸ´", "ğŸµ", "ğ—®", "ğ—¯", "ğ—°", "ğ—±", "ğ—²", "ğ—³", "ğ—´", "ğ—µ", "ğ—¶", "ğ—·", "ğ—¸", "ğ—¹", "ğ—º", "ğ—»", "ğ—¼", "ğ—½", "ğ—¾", "ğ—¿", "ğ˜€", "ğ˜", "ğ˜‚", "ğ˜ƒ", "ğ˜„", "ğ˜…", "ğ˜†", "ğ˜‡", "ğ—”", "ğ—•", "ğ—–", "ğ——", "ğ—˜", "ğ—™", "ğ—š", "ğ—›", "ğ—œ", "ğ—", "ğ—", "ğ—Ÿ", "ğ— ", "ğ—¡", "ğ—¢", "ğ—£", "ğ—¤", "ğ—¥", "ğ—¦", 'ğ—§', "ğ—¨", "ğ—©", "ğ—ª", "ğ—«", "ğ—¬", "ğ—­"],
        "sans-serif-italic": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ˜¢", "ğ˜£", "ğ˜¤", "ğ˜¥", "ğ˜¦", "ğ˜§", "ğ˜¨", "ğ˜©", "ğ˜ª", "ğ˜«", "ğ˜¬", "ğ˜­", "ğ˜®", "ğ˜¯", "ğ˜°", "ğ˜±", "ğ˜²", "ğ˜³", "ğ˜´", "ğ˜µ", "ğ˜¶", "ğ˜·", "ğ˜¸", "ğ˜¹", "ğ˜º", "ğ˜»", "ğ˜ˆ", "ğ˜‰", "ğ˜Š", "ğ˜‹", "ğ˜Œ", "ğ˜", "ğ˜", "ğ˜", "ğ˜", "ğ˜‘", "ğ˜’", "ğ˜“", "ğ˜”", "ğ˜•", "ğ˜–", "ğ˜—", "ğ˜˜", "ğ˜™", "ğ˜š", "ğ˜›", "ğ˜œ", "ğ˜", "ğ˜", "ğ˜Ÿ", "ğ˜ ", "ğ˜¡"],
        "sans-serif-bold-italic": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ™–", "ğ™—", "ğ™˜", "ğ™™", "ğ™š", "ğ™›", "ğ™œ", "ğ™", "ğ™", "ğ™Ÿ", "ğ™ ", "ğ™¡", "ğ™¢", "ğ™£", "ğ™¤", "ğ™¥", "ğ™¦", "ğ™§", "ğ™¨", "ğ™©", "ğ™ª", "ğ™«", "ğ™¬", "ğ™­", "ğ™®", "ğ™¯", "ğ˜¼", "ğ˜½", "ğ˜¾", "ğ˜¿", "ğ™€", "ğ™", "ğ™‚", "ğ™ƒ", "ğ™„", "ğ™…", "ğ™†", "ğ™‡", "ğ™ˆ", "ğ™‰", "ğ™Š", "ğ™‹", "ğ™Œ", "ğ™", "ğ™", "ğ™", "ğ™", "ğ™‘", "ğ™’", "ğ™“", "ğ™”", "ğ™•"],
        "script-regular": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ’¶", "ğ’·", "ğ’¸", "ğ’¹", "â„¯", "ğ’»", "â„Š", "ğ’½", "ğ’¾", "ğ’¿", "ğ“€", "ğ“", "ğ“‚", "ğ“ƒ", "â„´", "ğ“…", "ğ“†", "ğ“‡", "ğ“ˆ", "ğ“‰", "ğ“Š", "ğ“‹", "ğ“Œ", "ğ“", "ğ“", "ğ“", "ğ’œ", "â„¬", "ğ’", "ğ’Ÿ", "â„°", "â„±", "ğ’¢", "â„‹", "â„", "ğ’¥", "ğ’¦", "â„’", "â„³", "ğ’©", "ğ’ª", "ğ’«", "ğ’¬", "â„›", "ğ’®", "ğ’¯", "ğ’°", "ğ’±", "ğ’²", "ğ’³", "ğ’´", "ğ’µ"],
        "script-bold": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ“ª", "ğ“«", "ğ“¬", "ğ“­", "ğ“®", "ğ“¯", "ğ“°", "ğ“±", "ğ“²", "ğ“³", "ğ“´", "ğ“µ", "ğ“¶", "ğ“·", "ğ“¸", "ğ“¹", "ğ“º", "ğ“»", "ğ“¼", "ğ“½", "ğ“¾", "ğ“¿", "ğ”€", "ğ”", "ğ”‚", "ğ”ƒ", "ğ“", "ğ“‘", "ğ“’", "ğ““", "ğ“”", "ğ“•", "ğ“–", "ğ“—", "ğ“˜", "ğ“™", "ğ“š", "ğ“›", "ğ“œ", "ğ“", "ğ“", "ğ“Ÿ", "ğ“ ", "ğ“¡", "ğ“¢", "ğ“£", "ğ“¤", "ğ“¥", "ğ“¦", "ğ“§", "ğ“¨", "ğ“©"],
        "fraktur-regular": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ”", "ğ”Ÿ", "ğ” ", "ğ”¡", "ğ”¢", "ğ”£", "ğ”¤", "ğ”¥", "ğ”¦", "ğ”§", "ğ”¨", "ğ”©", "ğ”ª", "ğ”«", "ğ”¬", "ğ”­", "ğ”®", "ğ”¯", "ğ”°", "ğ”±", "ğ”²", "ğ”³", "ğ”´", "ğ”µ", "ğ”¶", "ğ”·", "ğ”„", "ğ”…", "â„­", "ğ”‡", "ğ”ˆ", "ğ”‰", "ğ”Š", "â„Œ", "â„‘", "ğ”", "ğ”", "ğ”", "ğ”", "ğ”‘", "ğ”’", "ğ”“", "ğ””", "â„œ", "ğ”–", "ğ”—", "ğ”˜", "ğ”™", "ğ”š", "ğ”›", "ğ”œ", "â„¨"],
        "fraktur-bold": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğ–†", "ğ–‡", "ğ–ˆ", "ğ–‰", "ğ–Š", "ğ–‹", "ğ–Œ", "ğ–", "ğ–", "ğ–", "ğ–", "ğ–‘", "ğ–’", "ğ–“", "ğ–”", "ğ–•", "ğ––", "ğ–—", "ğ–˜", "ğ–™", "ğ–š", "ğ–›", "ğ–œ", "ğ–", "ğ–", "ğ–Ÿ", "ğ•¬", "ğ•­", "ğ•®", "ğ•¯", "ğ•°", "ğ•±", "ğ•²", "ğ•³", "ğ•´", "ğ•µ", "ğ•¶", "ğ•·", "ğ•¸", "ğ•¹", "ğ•º", "ğ•»", "ğ•¼", "ğ•½", "ğ•¾", "ğ•¿", "ğ–€", "ğ–", "ğ–‚", "ğ–ƒ", "ğ–„", "ğ–…"],
        "monospace-regular": ["ğŸ¶", "ğŸ·", "ğŸ¸", "ğŸ¹", "ğŸº", "ğŸ»", "ğŸ¼", "ğŸ½", "ğŸ¾", "ğŸ¿", "ğšŠ", "ğš‹", "ğšŒ", "ğš", "ğš", "ğš", "ğš", "ğš‘", "ğš’", "ğš“", "ğš”", "ğš•", "ğš–", "ğš—", "ğš˜", "ğš™", "ğšš", "ğš›", "ğšœ", "ğš", "ğš", "ğšŸ", "ğš ", "ğš¡", "ğš¢", "ğš£", "ğ™°", "ğ™±", "ğ™²", "ğ™³", "ğ™´", "ğ™µ", "ğ™¶", "ğ™·", "ğ™¸", "ğ™¹", "ğ™º", "ğ™»", "ğ™¼", "ğ™½", "ğ™¾", "ğ™¿", "ğš€", "ğš", "ğš‚", "ğšƒ", "ğš„", "ğš…", "ğš†", "ğš‡", "ğšˆ", "ğš‰"],
        "double-struck-bold": ["ğŸ˜", "ğŸ™", "ğŸš", "ğŸ›", "ğŸœ", "ğŸ", "ğŸ", "ğŸŸ", "ğŸ ", "ğŸ¡", "ğ•’", "ğ•“", "ğ•”", "ğ••", "ğ•–", "ğ•—", "ğ•˜", "ğ•™", "ğ•š", "ğ•›", "ğ•œ", "ğ•", "ğ•", "ğ•Ÿ", "ğ• ", "ğ•¡", "ğ•¢", "ğ•£", "ğ•¤", "ğ•¥", "ğ•¦", "ğ•§", "ğ•¨", "ğ•©", "ğ•ª", "ğ•«", "ğ”¸", "ğ”¹", "â„‚", "ğ”»", "ğ”¼", "ğ”½", "ğ”¾", "â„", "ğ•€", "ğ•", "ğ•‚", "ğ•ƒ", "ğ•„", "â„•", "ğ•†", "â„™", "â„š", "â„", "ğ•Š", "ğ•‹", "ğ•Œ", "ğ•", "ğ•", "ğ•", "ğ•", "â„¤"],
        "circle-regular": ["â“ª", "â‘ ", "â‘¡", "â‘¢", "â‘£", "â‘¤", "â‘¥", "â‘¦", "â‘§", "â‘¨", "â“", "â“‘", "â“’", "â““", "â“”", "â“•", "â“–", "â“—", "â“˜", "â“™", "â“š", "â“›", "â“œ", "â“", "â“", "â“Ÿ", "â“ ", "â“¡", "â“¢", "â“£", "â“¤", "â“¥", "â“¦", "â“§", "â“¨", "â“©", "â’¶", "â’·", "â’¸", "â’¹", "â’º", "â’»", "â’¼", "â’½", "â’¾", "â’¿", "â“€", "â“", "â“‚", "â“ƒ", "â“„", "â“…", "â“†", "â“‡", "â“ˆ", "â“‰", "â“Š", "â“‹", "â“Œ", "â“", "â“", "â“"],
        "square-regular": ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "ğŸ„°", "ğŸ„±", "ğŸ„²", "ğŸ„³", "ğŸ„´", "ğŸ„µ", "ğŸ„¶", "ğŸ„·", "ğŸ„¸", "ğŸ„¹", "ğŸ„º", "ğŸ„»", "ğŸ„¼", "ğŸ„½", "ğŸ„¾", "ğŸ„¿", "ğŸ…€", "ğŸ…", "ğŸ…‚", "ğŸ…ƒ", "ğŸ…„", "ğŸ……", "ğŸ…†", "ğŸ…‡", "ğŸ…ˆ", "ğŸ…‰", "ğŸ„°", "ğŸ„±", "ğŸ„²", "ğŸ„³", "ğŸ„´", "ğŸ„µ", "ğŸ„¶", "ğŸ„·", "ğŸ„¸", "ğŸ„¹", "ğŸ„º", "ğŸ„»", "ğŸ„¼", "ğŸ„½", "ğŸ„¾", "ğŸ„¿", "ğŸ…€", "ğŸ…", "ğŸ…‚", "ğŸ…ƒ", "ğŸ…„", "ğŸ……", "ğŸ…†", "ğŸ…‡", "ğŸ…ˆ", "ğŸ…‰"],
        "modifier-letter": ["â°", "Â¹", "Â²", "Â³", "â´", "âµ", "â¶", "â·", "â¸", "â¹", "áµƒ", "áµ‡", "á¶œ", "áµˆ", "áµ‰", "á¶ ", "áµ", "Ê°", "â±", "Ê²", "áµ", "Ë¡", "áµ", "â¿", "áµ’", "áµ–", "áµ ", "Ê³", "Ë¢", "áµ—", "áµ˜", "áµ›", "Ê·", "Ë£", "Ê¸", "á¶»", "á´¬", "á´®", "á¶œ", "á´°", "á´±", "á¶ ", "á´³", "Ê°", "á´µ", "á´¶", "á´·", "á´¸", "á´¹", "á´º", "á´¼", "á´¾", "áµ ", "á´¿", "Ë¢", "áµ€", "áµ", "áµ›", "áµ‚", "Ë£", "Ê¸", "á¶»"],
    };

    // charCode => index in `TABLE`
    const INDEX = { "48": 0, "49": 1, "50": 2, "51": 3, "52": 4, "53": 5, "54": 6, "55": 7, "56": 8, "57": 9, "65": 36, "66": 37, "67": 38, "68": 39, "69": 40, "70": 41, "71": 42, "72": 43, "73": 44, "74": 45, "75": 46, "76": 47, "77": 48, "78": 49, "79": 50, "80": 51, "81": 52, "82": 53, "83": 54, "84": 55, "85": 56, "86": 57, "87": 58, "88": 59, "89": 60, "90": 61, "97": 10, "98": 11, "99": 12, "100": 13, "101": 14, "102": 15, "103": 16, "104": 17, "105": 18, "106": 19, "107": 20, "108": 21, "109": 22, "110": 23, "111": 24, "112": 25, "113": 26, "114": 27, "115": 28, "116": 29, "117": 30, "118": 31, "119": 32, "120": 33, "121": 34, "122": 35 };

    return proxies.map(p => {
        p.name = [...p.name].map(c => {
            if (/[a-zA-Z0-9]/.test(c)) {
                const code = c.charCodeAt(0);
                const index = INDEX[code];
                if (isNumber(code) && num) {
                    return TABLE[num][index];
                } else {
                    return TABLE[type][index];
                }
            }
            return c;
        }).join("");
        return p;
    })
}

function isNumber(code) { return code >= 48 && code <= 57; }

// åˆ¤æ–­æ˜¯å¦æ˜¯èŠ±é‡Œèƒ¡å“¨å­—ä½“æ“ä½œ
if ($arguments.type) {
    // å¦‚æœæ˜¯ï¼Œåˆ™å¯¼å‡ºèŠ±é‡Œèƒ¡å“¨å­—ä½“æ“ä½œå‡½æ•°
    $done({ operators: [fancyCharOperator] });
} else {
    // å¦åˆ™ï¼Œå¯¼å‡ºé‡å‘½åæ“ä½œå‡½æ•°
    $done({ operators: [operator] });
}
```